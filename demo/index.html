<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Demo of Spiel</title>
</head>
<body>
    <h1>Use "a" for change scene (scene1 => scene2)</h1>
    <h1>Use "z" for change scene (scene2 => scene1)</h1>
    <script src="./../lib/spiel.js"></script>
    <script>
        class T extends Spiel.Plugin{
            changeScene(entities, sceneName){
                console.log("changeScene", entities, sceneName)
            }
            sceneUpdate(entities, sceneName){
                console.log("sceneUpdate", entities, sceneName)
            }
            entityUpdate(entity){
                console.log("entityUpdate", entity)
            }
            onCanvas(canvas, entities, onEntities){
                console.log("onCanvas", canvas, entities, onEntities)
            }
            cameraUpdate(camera){
                console.log("cameraUpdate", camera)
            }
            getKeys(key){
                console.log("getKeys", key)
            }
            onFirstSetEntity(entity){
                console.log("onFirstSetEntity", entity)
            }
        }
        const game = new Spiel.Game({
            // plugins: [new T()],
            darkmode: true,
            pixel: true,
            save: true,
            load: {
                image1: Spiel.Loader.Image("./image3.png"),
                image2: Spiel.Loader.Image("./image2.png"),
                text2: Spiel.Loader.Text("*scene.state", {color: "#fff", fontSize: 33, padding: 7 + 7 / 3})
            },
            scene: [
                {
                    
                    name: "scene1",
                    state: {
                        test: "test"
                    },
                    entity: {
                        "@camera": class extends Spiel.Entity.Camera{
                            init(){
                                this.background = Spiel.Loader.Image("./bg.png")
                                this.setTarget("image2")
                            }
                        },
                        image2: class extends Spiel.Entity.Image{
                            init(){
                                this.index = 2
                                this.x = 350
                                this.y = 100
                            }
                            redraw(){
                                if(this.key.has("e")) console.log(this.scene.state.test)
                                if(this.key.has("ArrowUp")) this.y += -1
                                if(this.key.has("ArrowDown")) this.y += 1
                                if(this.key.has("ArrowLeft")) this.x += -1
                                if(this.key.has("ArrowRight")) this.x += 1
                            }
                        },
                        image1: Spiel.ex(class extends Spiel.Entity.Image{
                            init(){
                                this.body = {
                                    x: 2,
                                    y: 2,
                                    width: 46,
                                    height: 34
                                }
                                this.x = 100
                                this.y = 100
                            }
                            redraw(){
                                if(this.key.has("z")) console.log(this.scene.state.test)
                                if(this.key.has("a")){
                                    this.scene.state.test = "test2"
                                    this.changeScene("scene2")
                                }
                            }
                        }),
                        image3: Spiel.ex(class extends Spiel.Entity.Image{
                            init(){
                                this.use = "image2"
                                this.x = 350
                                this.y = 300
                            }
                        }),
                        text2: class extends Spiel.Entity.Text{
                            init(){
                                this.x = 0
                                this.y = 0
                                this.e = "test"
                            }
                        }
                    }
                },
                {backgroundColor: "#0ff",
                    name: "scene2",
                    entity: {
                        image1: Spiel.ex(class extends Spiel.Entity.Image{
                            init(){
                                this.x = 400
                                this.y = 400
                            }
                            redraw(){
                                if(this.key.has("z")){
                                    this.changeScene("scene1")
                                }
                            }
                        })
                    }
                },
            ]
        })
    </script>
</body>
</html>