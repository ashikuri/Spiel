<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Demo of Spiel</title>
</head>
<body>
    <h1>Use "a" for change scene (scene1 => scene2)</h1>
    <h1>Use "z" for change scene (scene2 => scene1)</h1>
    <script src="./../lib/spiel.js"></script>
    <script>
function shadeColor(color, percent) {

var R = parseInt(color.substring(1,3),16);
var G = parseInt(color.substring(3,5),16);
var B = parseInt(color.substring(5,7),16);

R = parseInt(R * (100 + percent) / 100);
G = parseInt(G * (100 + percent) / 100);
B = parseInt(B * (100 + percent) / 100);

R = (R<255)?R:255;  
G = (G<255)?G:255;  
B = (B<255)?B:255;  

var RR = ((R.toString(16).length==1)?"0"+R.toString(16):R.toString(16));
var GG = ((G.toString(16).length==1)?"0"+G.toString(16):G.toString(16));
var BB = ((B.toString(16).length==1)?"0"+B.toString(16):B.toString(16));

return "#"+RR+GG+BB;
}
        const game = new Spiel.Game({
            darkmode: true,
            pixel: true,
            save: true,
            load: {
                image1: Spiel.Loader.Image("./image3.png"),
                image2: Spiel.Loader.Image("./image2.png"),
                text2: Spiel.Loader.Text("salut", {color: "#fff", fontSize: 33, padding: 7 + 7 / 3}),
            },
            loadScene(ctx, p){

            },
            scene: [
                {
                    
                    name: "scene1",
                    state: {
                        test: "test"
                    },
                    entity: {
                        "@camera": class extends Spiel.Entity.Camera{
                            init(){
                                this.background = Spiel.Loader.Image("./bg.png")
                                this.setTarget("image2")
                            }
                        },
                        image1: Spiel.ex(class extends Spiel.Entity.Image{
                            init(){
                                this.body = {
                                    x: 2,
                                    y: 2,
                                    width: 46,
                                    height: 34
                                }
                                this.x = 100
                                this.y = 100
                            }
                            redraw(){
                                this.timeout(console.log, 500, 5)
                                this.timeout(console.info, 500, 5)
                                if(this.key.findIndex((v) =>v === "z") !== -1) console.log(this.scene.state.test)
                                if(this.key.findIndex((v) =>v === "a") !== -1){
                                    this.scene.state.test = "test2"
                                    this.changeScene("scene2")
                                }
                            }
                        }),
                        image2: class extends Spiel.Entity.Image{
                            init(){
                                this.x = 350
                                this.y = 100
                            }
                            redraw(){
                                if(this.key.findIndex((v) =>v === "e") !== -1) console.log(this.scene.state.test)
                                if(this.key.findIndex((key) =>key === "ArrowUp") !== -1) this.y += -1
                                if(this.key.findIndex((key) =>key === "ArrowDown") !== -1) this.y += 1
                                if(this.key.findIndex((key) =>key === "ArrowLeft") !== -1) this.x += -1
                                if(this.key.findIndex((key) =>key === "ArrowRight") !== -1) this.x += 1
                            }
                        },
                        text2: class extends Spiel.Entity.Text{
                            init(){
                                this.x = 0
                                this.y = 0 + 33
                                
                            }
                        },
                    }
                },
                {backgroundColor: "#0ff",
                    name: "scene2",
                    entity: {
                        image1: Spiel.ex(class extends Spiel.Entity.Image{
                            init(){
                                this.x = 400
                                this.y = 400
                            }
                            redraw(){
                                if(this.key.findIndex((v) =>v === "z") !== -1){
                                    this.changeScene("scene1")
                                }
                            }
                        })
                    }
                },
            ]
        })
    </script>
</body>
</html>